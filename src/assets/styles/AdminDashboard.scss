// ========================================================================
// 1. CONFIGURATION & VARIABLES
// ========================================================================

// --- Breakpoints ---
$breakpoint-md: 768px; // Tablets and up
$breakpoint-lg: 1024px; // Desktops and up

// --- Colors ---
$dashboard-bg: #161921;
$card-bg: #1f232d;
$header-bg: #4c38f1; // The purple header from your screenshot
$text-primary: #ffffff;
$text-secondary: #a0a8c2;
$accent-green: #00b929;
$error-red: #e53935;
$border-color: #333;

// --- Sidebar ---
$sidebar-bg: #061763; // The dark blue from your sidebar component
$sidebar-text-color: rgba(248, 250, 252, 0.7);
$sidebar-text-color-hover: #f8fafc;
$sidebar-active-bg: #334155;
$sidebar-active-accent: #06b6d4;
$sidebar-width-desktop: 260px;
$sidebar-width-mobile: 240px;

// --- Layout & Typography ---
$font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
$transition-speed: 0.3s;

// ========================================================================
// 2. MIXINS
// ========================================================================
@mixin tablet-and-up {
  @media (min-width: $breakpoint-md) { @content; }
}
@mixin mobile-only {
  @media (max-width: #{$breakpoint-md - 1px}) { @content; }
}

// ========================================================================
// 3. MAIN LAYOUT & WRAPPER
// ========================================================================
.dashboard-layout {
  display: flex;
  font-family: $font-family;
  min-height: 100vh;
  background-color: $dashboard-bg;
  color: $text-primary;
  position: relative; // Context for the mobile overlay

  // This class is toggled by JS on the wrapper when the mobile menu is open
  &.mobile-sidebar-open {
    overflow: hidden; // Prevent scrolling the page when the mobile menu is open
  }
}

// ========================================================================
// 4. SIDEBAR STYLES (Fully responsive)
// ========================================================================

.dashboard__sidebar {
  background-color: $sidebar-bg;
  color: $sidebar-text-color;
  position: fixed;
  left: 0;
  top: 0;
  height: 100vh;
  z-index: 1001;
  display: flex;
  flex-direction: column;
  transition: transform $transition-speed ease-in-out;
  box-shadow: 2px 0 15px rgba(0, 0, 0, 0.2);
  width: $sidebar-width-desktop;

  &-logo {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    img {
      height: 45px;
      width: 45px;
      margin-bottom: 10px;
    }
  }
  
  &-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0;
    color: $text-primary;
  }
  
  &-menu {
    list-style: none;
    padding: 0 15px;
    margin: 15px 0 0 0;
    flex-grow: 1;

    &-item a { // Styles for the NavLink
      display: block;
      padding: 12px 15px;
      margin: 8px 0;
      color: $sidebar-text-color;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.2s ease;
      font-weight: 500;
      position: relative;
      
      &:hover {
        background-color: rgba(75, 85, 99, 0.4);
        color: $sidebar-text-color-hover;
      }
      
      &.dashboard__sidebar-menu-item--active { 
        background-color: $sidebar-active-bg;
        color: $sidebar-text-color-hover;
        font-weight: 600;

        &::before {
          content: '';
          position: absolute;
          left: -15px;
          top: 0;
          height: 100%;
          width: 4px;
          background-color: $sidebar-active-accent;
          border-radius: 0 3px 3px 0;
        }
      }
    }
  }
  
  &-signout {
    margin: 20px 15px; 
    padding: 12px 15px;
    background-color: rgba($error-red, 0.8);
    color: white;
    border-radius: 6px;
    text-align: center;
    font-weight: 500;
    cursor: pointer;
    list-style-type: none;
    transition: background-color 0.2s ease;
    &:hover { background-color: $error-red; }
  }
}

// --- Sidebar Mobile Toggle & Overlay ---
.dashboard__sidebar-toggle { display: none; }
.dashboard__sidebar-overlay { display: none; }

// --- Sidebar Responsive Behavior ---
@include mobile-only {
  .dashboard__sidebar {
    width: $sidebar-width-mobile;
    transform: translateX(-100%); // Hidden by default on mobile
    
    &.is-open {
      transform: translateX(0);
    }
  }

  .dashboard__sidebar-toggle {
    display: block;
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 1005;
    background: $sidebar-active-bg;
    color: $text-primary;
    border: none;
    padding: 10px;
    cursor: pointer;
    border-radius: 50%;
    font-size: 1.5rem;
    line-height: 1;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  }
  
  .dashboard-layout.mobile-sidebar-open .dashboard__sidebar-overlay {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
  }
}

// ========================================================================
// 5. MAIN CONTENT AREA (The Fix for the Layout)
// ========================================================================
.dashboard-main-content {
  flex-grow: 1;
  padding: 1.5rem;
  width: 100%;
  min-width: 0; // Fixes flexbox overflow issues
  transition: margin-left $transition-speed ease;

  // On desktop, add left margin to make space for the fixed sidebar.
  @include tablet-and-up {
    margin-left: $sidebar-width-desktop;
    padding: 2.5rem;
  }
}

// ========================================================================
// 6. HEADER, GRID, CARDS, & OTHER CONTENT STYLES
// ========================================================================
.dashboard-content-header {
  background-color: $header-bg;
  padding: 1.5rem;
  border-radius: 12px;
  margin-bottom: 2.5rem;

  .header-title {
    font-size: 2rem;
    font-weight: 700;
    margin: 0 0 8px 0;
  }
  .header-subtitle, .header-stats {
    color: rgba($text-primary, 0.8);
  }

  @include tablet-and-up {
    padding: 2rem;
    .header-title { font-size: 2.5rem; }
  }
}

.dashboard-grid-cards {
  display: grid;
  // Responsive grid: starts with 1 column, goes to more as space allows
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
}

.dashboard-card {
  background-color: $card-bg;
  padding: 25px;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  min-height: 300px;
  border: 1px solid $border-color;

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    color: $text-secondary;
  }
  .card-title {
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: $text-primary;
  }
  .card-body {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }
  .amount {
    font-size: 2.2rem;
    font-weight: bold;
    margin: 0 0 5px 0;
  }
  .change {
    font-size: 0.9rem;
    margin: 0 0 1rem 0;
    color: $accent-green;
  }
  .chart-container-line {
    flex-grow: 1;
    min-height: 140px;
    margin-top: auto;
  }
}

// Transaction list inside a card
.transaction-list {
  margin-top: auto; // Pushes to the bottom
}
.transaction-item {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  border-top: 1px solid $border-color;
  &:first-of-type { border-top: none; }
}

// Chart Tooltip
.custom-tooltip {
  background-color: rgba(31, 35, 45, 0.95);
  border: 1px solid #444;
  padding: 10px 15px;
  border-radius: 8px;
  p:first-child { font-weight: 600; margin-bottom: 5px; }
}
