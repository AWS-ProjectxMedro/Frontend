"use strict";(self.webpackChunkthecapitaltree=self.webpackChunkthecapitaltree||[]).push([[837],{5837:(a,e,t)=>{t.r(e),t.d(e,{default:()=>i});var r=t(5043),s=t(3216),n=t(6213),o=t(7488),l=t(579);const c="http://43.204.120.102:3308",i=()=>{(0,s.Zp)();const[a,e]=(0,r.useState)({amount:"",bankAccount:"",accountHolder:"",ifscCode:"",reason:""}),[t,i]=(0,r.useState)(!1),[d,h]=(0,r.useState)(0),[u,m]=(0,r.useState)([]);(0,r.useEffect)((()=>{w(),p()}),[]);const w=async()=>{try{const a=localStorage.getItem("authToken"),e=await n.A.get(`${c}/api/users/balance`,{headers:{Authorization:`Bearer ${a}`}});h(e.data.balance||0)}catch(a){console.error("Error fetching balance:",a),o.oR.error("Failed to fetch account balance")}},p=async()=>{try{const a=localStorage.getItem("authToken"),e=await n.A.get(`${c}/api/withdrawals/my`,{headers:{Authorization:`Bearer ${a}`}}),t=e.data.withdrawals||e.data.data||e.data||[];m(Array.isArray(t)?t:[])}catch(a){console.error("Error fetching withdrawal history:",a),o.oR.error("Failed to fetch withdrawal history")}},x=t=>{e({...a,[t.target.name]:t.target.value})},j=a=>{switch(null===a||void 0===a?void 0:a.toLowerCase()){case"approved":case"completed":case"success":return"#4CAF50";case"pending":case"processing":return"#FF9800";case"rejected":case"failed":case"cancelled":return"#F44336";default:return"#757575"}},f=a=>{try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"Invalid Date"}};return(0,l.jsx)("div",{className:"withdrawal-page-container",children:(0,l.jsx)("div",{className:"withdrawal-content-area",children:(0,l.jsxs)("div",{className:"withdrawal-central-hub",children:[(0,l.jsx)("h2",{className:"withdrawal-title",children:"Withdrawal Request"}),(0,l.jsxs)("div",{className:"withdrawal-balance-display",children:[(0,l.jsx)("span",{className:"withdrawal-balance-text",children:"Available Balance:"}),(0,l.jsxs)("span",{className:"withdrawal-balance-value",children:["\u20b9",d.toFixed(2)]})]}),(0,l.jsx)("div",{className:"withdrawal-form-wrapper",children:(0,l.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),parseFloat(a.amount)>d)o.oR.error("Insufficient balance for withdrawal");else if(parseFloat(a.amount)<100)o.oR.error("Minimum withdrawal amount is \u20b9100");else{i(!0);try{const t=localStorage.getItem("authToken"),r={amount:parseFloat(a.amount),bankAccount:a.bankAccount,accountHolder:a.accountHolder,ifscCode:a.ifscCode,reason:a.reason||"Withdrawal request"},s=await n.A.post(`${c}/api/withdrawals`,r,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});o.oR.success(s.data.message||"Withdrawal request submitted successfully!"),e({amount:"",bankAccount:"",accountHolder:"",ifscCode:"",reason:""}),w(),p()}catch(u){var r,s,l,h;console.error("Withdrawal error:",u);const a=(null===(r=u.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||(null===(l=u.response)||void 0===l||null===(h=l.data)||void 0===h?void 0:h.error)||"Failed to submit withdrawal request";o.oR.error(a)}finally{i(!1)}}},className:"withdrawal-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"amount",children:"Withdrawal Amount (INR):"}),(0,l.jsx)("input",{type:"number",name:"amount",id:"amount",value:a.amount,onChange:x,placeholder:"Enter amount to withdraw",min:"100",max:d,step:"0.01",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"accountHolder",children:"Account Holder Name:"}),(0,l.jsx)("input",{type:"text",name:"accountHolder",id:"accountHolder",value:a.accountHolder,onChange:x,placeholder:"Enter account holder name",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"bankAccount",children:"Bank Account Number:"}),(0,l.jsx)("input",{type:"text",name:"bankAccount",id:"bankAccount",value:a.bankAccount,onChange:x,placeholder:"Enter bank account number",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"ifscCode",children:"IFSC Code:"}),(0,l.jsx)("input",{type:"text",name:"ifscCode",id:"ifscCode",value:a.ifscCode,onChange:x,placeholder:"Enter IFSC code (e.g. SBIN0001234)",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"reason",children:"Reason for Withdrawal:"}),(0,l.jsx)("textarea",{name:"reason",id:"reason",value:a.reason,onChange:x,placeholder:"Enter reason for withdrawal (optional)",rows:"3"})]}),(0,l.jsx)("div",{className:"withdrawal-action-button-container",children:(0,l.jsx)("button",{type:"submit",className:"withdrawal-submit-button",disabled:t||!a.amount||!a.bankAccount||!a.accountHolder||!a.ifscCode,children:t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"withdrawal-activity-indicator"}),(0,l.jsx)("span",{children:"Processing..."})]}):"Request Withdrawal "+(a.amount?`\u20b9${a.amount}`:"")})})]})}),u.length>0&&(0,l.jsxs)("div",{className:"withdrawal-history-section",children:[(0,l.jsx)("h3",{children:"Withdrawal History"}),(0,l.jsx)("div",{className:"withdrawal-history-list",children:u.map(((a,e)=>(0,l.jsxs)("div",{className:"withdrawal-history-item",children:[(0,l.jsxs)("div",{className:"withdrawal-history-info",children:[(0,l.jsxs)("span",{className:"withdrawal-amount",children:["\u20b9",a.amount||"0.00"]}),(0,l.jsx)("span",{className:"withdrawal-date",children:f(a.createdAt||a.created_at)}),a.reason&&(0,l.jsx)("span",{className:"withdrawal-reason",children:a.reason})]}),(0,l.jsx)("div",{className:"withdrawal-status",style:{color:j(a.status)},children:a.status||"Pending"})]},a.id||e)))})]}),0===u.length&&(0,l.jsx)("div",{className:"withdrawal-no-history",children:(0,l.jsx)("p",{children:"No withdrawal history found."})})]})})})}}}]);
//# sourceMappingURL=837.8e230e5e.chunk.js.map