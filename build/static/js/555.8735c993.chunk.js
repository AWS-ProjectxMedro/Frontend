"use strict";(self.webpackChunkthecapitaltree=self.webpackChunkthecapitaltree||[]).push([[555],{6555:(e,r,s)=>{s.r(r),s.d(r,{default:()=>o});var a=s(5043),t=s(6213),n=s(3216),i=s(579);const o=()=>{const[e,r]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[l,d]=(0,a.useState)(null),c=(0,n.Zp)(),{onLogout:h}=(0,n.KC)()||{},u="http://43.204.120.102:3308",m=e=>{if(!e)return"N/A";const r=new Date(e);return isNaN(r.getTime())?"Invalid Date":r.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};return(0,a.useEffect)((()=>{const e=localStorage.getItem("authToken"),s=localStorage.getItem("userRole");if(!e||"admin"!==s)return d("Unauthorized: No valid admin token or role. Please log in."),o(!1),void(h?h():c("/login"));o(!0),d(null),t.A.get(`${u}/api/users`,{headers:{Authorization:`Bearer ${e}`}}).then((e=>{let s=[];if(Array.isArray(e.data))s=e.data;else{if(!e.data||"object"!==typeof e.data)throw console.error("Invalid data format received for users:",e.data),new Error("Invalid data format received from API");if(s=e.data.users||e.data.data||[],!Array.isArray(s))throw console.error("Expected users array, but got:",s),s=[],new Error("Invalid data format for users list")}r(s),o(!1)})).catch((e=>{console.error("Error fetching users:",e);let r="Failed to fetch users.";e.response?(r+=` Server responded with status ${e.response.status}.`,e.response.data&&e.response.data.message&&(r+=` Message: ${e.response.data.message}`),401!==e.response.status&&403!==e.response.status||(r+=" Your session may have expired or you lack permission. Please log in again.",h?h():(localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),c("/login")))):e.request?r+=" No response received from server. Check API server and network.":r+=` Error: ${e.message}`,d(r),o(!1)}))}),[u,c,h]),!s||e.length||l?(0,i.jsxs)("div",{className:"user-management-page",children:[" ",(0,i.jsx)("h2",{children:"User Management"}),s&&e.length>0&&(0,i.jsx)("p",{children:"Updating user list..."})," ",l&&(0,i.jsx)("p",{className:"error-message",style:{color:"red",border:"1px solid red",padding:"10px"},children:l}),!s&&!l&&0===e.length&&(0,i.jsx)("p",{children:"No users found."}),!l&&e.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)("table",{className:"user-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Email"}),(0,i.jsx)("th",{children:"Phone"}),(0,i.jsx)("th",{children:"Role"}),(0,i.jsx)("th",{children:"Verified"}),(0,i.jsx)("th",{children:"Joined"})]})}),(0,i.jsx)("tbody",{children:e.map((e=>(0,i.jsxs)("tr",{children:[" ",(0,i.jsx)("td",{children:e.name||"N/A"}),(0,i.jsx)("td",{children:e.email||"N/A"}),(0,i.jsx)("td",{children:e.phone||"N/A"}),(0,i.jsx)("td",{children:e.role||"N/A"}),(0,i.jsxs)("td",{children:[e.isEmailVerified?"Email \u2713":"Email \u2717"," | ",e.isPhoneVerified?"Phone \u2713":"Phone \u2717"]}),(0,i.jsx)("td",{children:m(e.createdAt||e.registrationDate)})," "]},e.id||e._id)))})]})}),(0,i.jsxs)("div",{className:"pagination",children:[(0,i.jsx)("button",{disabled:!0,children:"\u276e"}),(0,i.jsx)("span",{children:"1"}),(0,i.jsx)("button",{disabled:!0,children:"\u276f"})]})]})]}):(0,i.jsx)("div",{className:"user-management-page",children:(0,i.jsx)("p",{children:"Loading users..."})})}}}]);
//# sourceMappingURL=555.8735c993.chunk.js.map