"use strict";(self.webpackChunkthecapitaltree=self.webpackChunkthecapitaltree||[]).push([[231],{1256:(e,a,r)=>{r.d(a,{A:()=>d});var s=r(5043),i=r(3216),t=r(5475),o=r(7956),l=r(184),n=r(579);const d=e=>{let{onLogout:a}=e;const[r,d]=(0,s.useState)(!1),c=(0,i.Zp)(),m=()=>{d(!r)},h=()=>{r&&d(!1)};return(0,s.useEffect)((()=>{if(r){const e=()=>d(!1);return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}}}),[r]),(0,n.jsxs)("div",{className:"dashboard-container-wrapper "+(r?"mobile-sidebar-open":""),children:[(0,n.jsx)("button",{className:"dashboard__sidebar-toggle",onClick:m,"aria-label":"Toggle navigation","aria-expanded":r,children:r?(0,n.jsx)(l.QCr,{}):(0,n.jsx)(l.OXb,{})}),(0,n.jsxs)("aside",{className:"dashboard__sidebar "+(r?"is-open":""),children:[(0,n.jsxs)("div",{className:"dashboard__sidebar-logo",children:[(0,n.jsx)("img",{src:o,alt:"logo",height:"50px",width:"50px"}),(0,n.jsx)("h2",{className:"dashboard__sidebar-title",children:"Dashboard"})]}),(0,n.jsxs)("ul",{className:"dashboard__sidebar-menu",children:[(0,n.jsx)("li",{className:"dashboard__sidebar-menu-item",children:(0,n.jsx)(t.k2,{to:"/dashboard",end:!0,onClick:h,className:e=>{let{isActive:a}=e;return a?"dashboard__sidebar-menu-item--active":""},children:"Dashboard"})}),(0,n.jsx)("li",{className:"dashboard__sidebar-menu-item",children:(0,n.jsx)(t.k2,{to:"/dashboard/investmenttools",onClick:h,className:e=>{let{isActive:a}=e;return a?"dashboard__sidebar-menu-item--active":""},children:"Investment Tool"})}),(0,n.jsx)("li",{className:"dashboard__sidebar-menu-item",children:(0,n.jsx)(t.k2,{to:"/dashboard/marketguides",onClick:h,className:e=>{let{isActive:a}=e;return a?"dashboard__sidebar-menu-item--active":""},children:"Market Guides"})}),(0,n.jsx)("li",{className:"dashboard__sidebar-menu-item",children:(0,n.jsx)(t.k2,{to:"/dashboard/profile",onClick:h,className:e=>{let{isActive:a}=e;return a?"dashboard__sidebar-menu-item--active":""},children:"Profile"})}),(0,n.jsx)("li",{className:"dashboard__sidebar-menu-item",children:(0,n.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),h(),c("/dashboard/payment",{state:{isManualPayment:!0,purchaseDetails:null}})},className:"dashboard__sidebar-menu-link",children:"Payment"})}),(0,n.jsx)("li",{className:"dashboard__sidebar-menu-item",children:(0,n.jsx)(t.k2,{to:"/dashboard/withdrawal",onClick:h,className:e=>{let{isActive:a}=e;return a?"dashboard__sidebar-menu-item--active":""},children:"Withdrawal"})}),(0,n.jsx)("li",{className:"dashboard__sidebar-signout",onClick:()=>{"function"===typeof a?a():(console.error("Sidebar: onLogout prop is missing or not a function!"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),window.location.href="/login"),h()},style:{cursor:"pointer"},children:"Sign Out"})]})]}),r&&(0,n.jsx)("div",{className:"dashboard__sidebar-overlay",onClick:m})]})}},2342:()=>{},7956:(e,a,r)=>{e.exports=r.p+"static/media/logo3.53e806f77f8987aa2fc1.png"},8171:(e,a,r)=>{e.exports=r.p+"static/media/logo4.53e806f77f8987aa2fc1.png"},9231:(e,a,r)=>{r.r(a),r.d(a,{default:()=>h});var s=r(5043),i=r(1256),t=r(8171),o=r(7488),l=(r(2342),r(6213)),n=r(579);const d="http://43.204.120.102:3308",c=e=>{let{initialData:a,onKycUpdateSuccess:r}=e;const[i,t]=(0,s.useState)({aadhaarNumber:"",panNumber:""}),[c,m]=(0,s.useState)({aadhaarDoc:null,panDoc:null}),[h,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{a&&t({aadhaarNumber:a.aadhaarNumber||"",panNumber:a.panNumber||""})}),[a]);const p=e=>{const{name:a,value:r}=e.target;t((e=>({...e,[a]:r})))},b=e=>{const{name:a,files:r}=e.target;r.length>0&&m((e=>({...e,[a]:r[0]})))};return a.kycCompleted?(0,n.jsxs)("section",{className:"kyc-verification card",children:[(0,n.jsx)("h3",{children:"KYC Verification"}),(0,n.jsxs)("div",{className:"kyc-verified-status",children:[(0,n.jsx)("span",{role:"img","aria-label":"check-mark",children:"\u2705"}),"Your KYC is verified. No further action is needed."]})]}):(0,n.jsxs)("section",{className:"kyc-verification card",children:[(0,n.jsx)("h3",{children:"KYC Verification"}),(0,n.jsx)("p",{children:"Please provide your Aadhaar and PAN details for verification."}),(0,n.jsxs)("form",{className:"profile-form",onSubmit:async e=>{if(e.preventDefault(),!i.aadhaarNumber||!i.panNumber||!c.aadhaarDoc||!c.panDoc)return void o.oR.warn("Please fill all fields and upload both documents.");u(!0);const a=localStorage.getItem("authToken");try{const e=new FormData;e.append("aadhaarDoc",c.aadhaarDoc),e.append("panDoc",c.panDoc);const s=`${d}/api/users/profile/upload`,t=await l.A.post(s,e,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${a}`}}),{aadhaarDocUrl:n,panDocUrl:m}=t.data;if(!n||!m)throw new Error("File upload did not return the expected URLs.");const h={...i,aadhaarDocUrl:n,panDocUrl:m},u=`${d}/api/users/profile`;await l.A.put(u,h,{headers:{Authorization:`Bearer ${a}`}}),o.oR.success("KYC details submitted successfully for verification!"),r&&r()}catch(n){var s,t;console.error("KYC Submission Error:",n),o.oR.error((null===(s=n.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.message)||"An error occurred during KYC submission.")}finally{u(!1)}},children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"aadhaarNumber",children:"Aadhaar Number"}),(0,n.jsx)("input",{type:"text",id:"aadhaarNumber",name:"aadhaarNumber",placeholder:"Enter 12-digit Aadhaar Number",value:i.aadhaarNumber,onChange:p,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"aadhaarDoc",children:"Upload Aadhaar Document (PDF, JPG, PNG)"}),(0,n.jsx)("input",{type:"file",id:"aadhaarDoc",name:"aadhaarDoc",onChange:b,accept:".pdf,.jpg,.jpeg,.png",required:!0}),c.aadhaarDoc&&(0,n.jsxs)("span",{className:"file-name",children:["Selected: ",c.aadhaarDoc.name]}),a.aadhaarDocUrl&&!c.aadhaarDoc&&(0,n.jsxs)("span",{className:"file-name",children:["Previously uploaded. ",(0,n.jsx)("a",{href:a.aadhaarDocUrl,target:"_blank",rel:"noopener noreferrer",children:"View"})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"panNumber",children:"PAN Number"}),(0,n.jsx)("input",{type:"text",id:"panNumber",name:"panNumber",placeholder:"Enter 10-character PAN",value:i.panNumber,onChange:p,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"panDoc",children:"Upload PAN Document (PDF, JPG, PNG)"}),(0,n.jsx)("input",{type:"file",id:"panDoc",name:"panDoc",onChange:b,accept:".pdf,.jpg,.jpeg,.png",required:!0}),c.panDoc&&(0,n.jsxs)("span",{className:"file-name",children:["Selected: ",c.panDoc.name]}),a.panDocUrl&&!c.panDoc&&(0,n.jsxs)("span",{className:"file-name",children:["Previously uploaded. ",(0,n.jsx)("a",{href:a.panDocUrl,target:"_blank",rel:"noopener noreferrer",children:"View"})]})]}),(0,n.jsx)("button",{type:"submit",className:"btn-primary",disabled:h,children:h?"Submitting KYC...":"Submit for Verification"})]})]})},m="http://43.204.120.102:3308",h=()=>{const[e,a]=(0,s.useState)({firstName:"",lastName:"",email:"",dob:"",address:"",city:"",country:"",profilePictureUrl:t,aadhaarNumber:"",panNumber:"",aadhaarDocUrl:"",panDocUrl:"",kycCompleted:!1}),[r,d]=(0,s.useState)(!0),[h,u]=(0,s.useState)(!1),p=(0,s.useCallback)((async()=>{const e=localStorage.getItem("authToken");if(!e)return o.oR.error("Authentication token not found. Please log in again."),void d(!1);d(!0);try{const r=`${m}/api/users/profile`,s=(await l.A.get(r,{headers:{Authorization:`Bearer ${e}`}})).data;console.log("Profile.jsx: Fetched user data from API:",s),a({...s,dob:s.dob?new Date(s.dob).toISOString().split("T")[0]:"",profilePictureUrl:s.profilePictureUrl||t}),localStorage.setItem("userData",JSON.stringify(s))}catch(i){var r,s;console.error("Profile.jsx: Error fetching profile data:",i),o.oR.error((null===(r=i.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message)||"Could not load your profile.")}finally{d(!1)}}),[]);(0,s.useEffect)((()=>{p()}),[p]);const b=e=>{const{name:r,value:s}=e.target;a((e=>({...e,[r]:s})))};return r&&!e.email?(0,n.jsxs)("div",{className:"dashboard-profile",children:[(0,n.jsx)(i.A,{}),(0,n.jsx)("main",{className:"main-content-profile",children:(0,n.jsx)("p",{style:{textAlign:"center",marginTop:"50px",fontSize:"1.2rem"},children:"Loading Your Profile..."})})]}):(0,n.jsxs)("div",{className:"dashboard-profile",children:[(0,n.jsx)(i.A,{}),(0,n.jsxs)("main",{className:"main-content-profile",children:[(0,n.jsxs)("section",{className:"user-profile card",children:[(0,n.jsx)("h3",{children:"User Profile Setting"}),(0,n.jsxs)("form",{className:"profile-form",onSubmit:async r=>{r.preventDefault(),u(!0);const s=localStorage.getItem("authToken");if(!s)return o.oR.error("Authentication token expired. Please log in again."),void u(!1);try{const r={firstName:e.firstName,lastName:e.lastName,dob:e.dob,address:e.address,city:e.city,country:e.country},i=`${m}/api/users/profile`,t=await l.A.put(i,r,{headers:{Authorization:`Bearer ${s}`}});o.oR.success("Profile updated successfully!");const n=t.data.user;localStorage.setItem("userData",JSON.stringify(n)),a((e=>({...e,...n,dob:n.dob?new Date(n.dob).toISOString().split("T")[0]:""})))}catch(n){var i,t;console.error("Profile.jsx: Error updating profile:",n),o.oR.error((null===(i=n.response)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.message)||"Failed to update profile.")}finally{u(!1)}},children:[(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"firstName",children:"First Name"}),(0,n.jsx)("input",{type:"text",id:"firstName",name:"firstName",placeholder:"First Name",value:e.firstName,onChange:b})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"lastName",children:"Last Name"}),(0,n.jsx)("input",{type:"text",id:"lastName",name:"lastName",placeholder:"Last Name",value:e.lastName,onChange:b})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"profileEmail",children:"Email Address"}),(0,n.jsx)("input",{type:"email",id:"profileEmail",name:"email",placeholder:"Email Address",value:e.email,readOnly:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"dob",children:"Date of Birth"}),(0,n.jsx)("input",{type:"date",id:"dob",name:"dob",value:e.dob,onChange:b})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"address",children:"Address"}),(0,n.jsx)("input",{type:"text",id:"address",name:"address",placeholder:"Your Street Address",value:e.address,onChange:b})]}),(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"city",children:"City"}),(0,n.jsx)("input",{type:"text",id:"city",name:"city",placeholder:"City",value:e.city,onChange:b})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"country",children:"Country"}),(0,n.jsx)("input",{type:"text",id:"country",name:"country",placeholder:"Country",value:e.country,onChange:b})]})]}),(0,n.jsx)("button",{type:"submit",className:"btn-primary",disabled:h,children:h?"Saving...":"Save Changes"})]})]}),(0,n.jsx)(c,{initialData:e,onKycUpdateSuccess:p})]}),(0,n.jsx)(o.N9,{position:"top-right",autoClose:4e3,hideProgressBar:!1})]})}}}]);
//# sourceMappingURL=231.073f1457.chunk.js.map