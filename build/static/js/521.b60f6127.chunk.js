"use strict";(self.webpackChunkthecapitaltree=self.webpackChunkthecapitaltree||[]).push([[521],{521:(e,a,s)=>{s.r(a),s.d(a,{default:()=>N});var t=s(5043),n=s(3216),i=s(6213),r=s(3930),l=s(579);const o="http://43.204.120.102:3308",d={AUTH_TOKEN:"authToken",USER_ROLE:"userRole",USER_DATA:"userData"},c={ADMIN:"admin"},m={LOGIN:"/login"},h={ADMIN_INVESTMENT_SUMMARY:"/api/transactions/summary?period=yearly"},u={MOBILE_BREAKPOINT:768},v=i.A.create({baseURL:o,timeout:1e4});v.interceptors.request.use((e=>{const a=localStorage.getItem(d.AUTH_TOKEN);return a&&(e.headers.Authorization=`Bearer ${a}`),e}),(e=>Promise.reject(e))),v.interceptors.response.use((e=>e),(e=>{var a;return 401===(null===(a=e.response)||void 0===a?void 0:a.status)&&(localStorage.removeItem(d.AUTH_TOKEN),localStorage.removeItem(d.USER_ROLE),localStorage.removeItem(d.USER_DATA)),Promise.reject(e)}));const g=e=>{let{onClick:a,isOpen:s}=e;return(0,l.jsxs)("button",{className:"hamburger-menu "+(s?"open":""),onClick:a,"aria-label":"Toggle navigation","aria-expanded":s,type:"button",children:[(0,l.jsx)("span",{}),(0,l.jsx)("span",{}),(0,l.jsx)("span",{})]})},N=e=>{let{onLogout:a}=e;const s=(0,n.Zp)(),i=(0,n.zy)(),[o,N]=(0,t.useState)({}),[x,p]=(0,t.useState)(window.innerWidth>u.MOBILE_BREAKPOINT),[_,j]=(0,t.useState)(null),[b,A]=(0,t.useState)(!0),I=(0,t.useCallback)((()=>{a&&a(),localStorage.removeItem(d.AUTH_TOKEN),localStorage.removeItem(d.USER_ROLE),localStorage.removeItem(d.USER_DATA),s(m.LOGIN)}),[a,s]),k=(0,t.useCallback)((async()=>{A(!0);try{const e=await v.get(h.ADMIN_INVESTMENT_SUMMARY);e.data?j(e.data.summary||e.data):j({error:!0,message:"No data received"})}catch(t){var e,a,s;if(console.error("Error fetching activated investment:",t),401===(null===(e=t.response)||void 0===e?void 0:e.status))return void I();j({error:!0,message:(null===(a=t.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to fetch data"})}finally{A(!1)}}),[I]),E=(0,t.useCallback)((()=>{p(window.innerWidth>u.MOBILE_BREAKPOINT)}),[]);(0,t.useEffect)((()=>{const e=localStorage.getItem(d.AUTH_TOKEN),a=localStorage.getItem(d.USER_ROLE);if(!e||a!==c.ADMIN)return void I();const s=localStorage.getItem(d.USER_DATA);if(s)try{N(JSON.parse(s))}catch{N({})}return k(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)}),[I,k,E]),(0,t.useEffect)((()=>{window.innerWidth<=u.MOBILE_BREAKPOINT&&x&&p(!1)}),[i.pathname]);const S=(0,t.useCallback)((()=>{p((e=>!e))}),[]);return(0,l.jsxs)("div",{className:"dashboard-layout "+(x?"sidebar-visible":"sidebar-hidden"),children:[(0,l.jsx)(r.A,{onLogout:I,isOpen:x,toggleSidebar:S}),(0,l.jsxs)("main",{className:"main-content-Admin",children:[(0,l.jsxs)("header",{className:"Admin-header",children:[(0,l.jsxs)("div",{className:"header-left",children:[(0,l.jsx)(g,{onClick:S,isOpen:x}),(0,l.jsx)("h1",{children:"Investment Insight - Admin Panel"})]}),(0,l.jsxs)("div",{className:"header-right",children:[(0,l.jsxs)("div",{className:"sub-header",children:["Welcome, ",o.email||o.firstName||"Admin"]}),(0,l.jsx)("div",{className:"header-summary",children:(()=>{return b?(0,l.jsx)("p",{children:"Loading summary..."}):null!==_&&void 0!==_&&_.error?(0,l.jsx)("p",{children:(0,l.jsxs)("span",{className:"error-detail",children:[" (",_.message,")"]})}):_?(0,l.jsxs)("p",{children:["Activated Investment:"," ",(0,l.jsx)("strong",{children:(e=_.totalInvestment,"number"===typeof e?`$${e.toLocaleString()}`:"N/A")})]}):(0,l.jsx)("p",{children:"No investment data available."});var e})()})]})]}),(0,l.jsx)("div",{className:"page-content-wrapper",children:(0,l.jsx)(n.sv,{context:{userData:o,onLogout:I,activatedInvestment:_,isLoadingInvestment:b,refreshInvestmentData:k}})})]})]})}},3930:(e,a,s)=>{s.d(a,{A:()=>l});s(5043);var t=s(3216),n=s(5475),i=s(7956),r=s(579);const l=e=>{let{onLogout:a,isOpen:s,onClose:l}=e;const o=(0,t.Zp)(),d=()=>{"function"===typeof a?a():(localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),o("/login"))},c=()=>{l&&window.innerWidth<=768&&l()};return(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsx)("div",{className:"admin-sidebar__overlay",onClick:e=>{e.target.classList.contains("admin-sidebar__overlay")&&l()},"aria-hidden":"true"}),(0,r.jsxs)("aside",{className:"admin-sidebar "+(s?"open":""),children:[(0,r.jsxs)("div",{className:"admin-sidebar__logo-section",children:[(0,r.jsx)("img",{src:i,alt:"logo",height:"50px",width:"50px"}),(0,r.jsx)("h2",{className:"admin-sidebar__title",children:"Admin Dashboard"})]}),(0,r.jsxs)("ul",{className:"admin-sidebar__menu",children:[(0,r.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,r.jsx)(n.k2,{to:"/adminDashboard",end:!0,className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Invest Dashboard"})}),(0,r.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,r.jsx)(n.k2,{to:"/adminDashboard/userManagement",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"User Management"})}),(0,r.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,r.jsx)(n.k2,{to:"/adminDashboard/manageBlog",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Manage Blog"})}),(0,r.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,r.jsx)(n.k2,{to:"/adminDashboard/transaction",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Transactions"})}),(0,r.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,r.jsx)(n.k2,{to:"/adminDashboard/withdrawals",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Withdrawals"})}),(0,r.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,r.jsx)(n.k2,{to:"/adminDashboard/adminPlans",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Plans"})})]}),(0,r.jsx)("div",{className:"admin-sidebar__signout",onClick:d,style:{cursor:"pointer"},tabIndex:0,role:"button",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||d()},children:"Sign Out"})]})]})}},7956:(e,a,s)=>{e.exports=s.p+"static/media/logo3.53e806f77f8987aa2fc1.png"}}]);
//# sourceMappingURL=521.b60f6127.chunk.js.map