"use strict";(self.webpackChunkthecapitaltree=self.webpackChunkthecapitaltree||[]).push([[501],{501:(e,a,n)=>{n.r(a),n.d(a,{default:()=>g});var l=n(5043),t=n(3930),s=n(6213),i=n(579);const o="http://43.204.120.102:3308",r=s.A.create({baseURL:`${o}/api`}),d=()=>localStorage.getItem("authToken");r.interceptors.request.use((e=>{const a=d();return a&&(e.headers.Authorization=`Bearer ${a}`),e}),(e=>Promise.reject(e)));const c=e=>{let{isOpen:a,onClose:n,children:l}=e;return a?(0,i.jsx)("div",{className:"modal-overlay-manageBlog",children:(0,i.jsxs)("div",{className:"modal-content-manageBlog",children:[(0,i.jsx)("button",{className:"modal-close-manageBlog",onClick:n,children:"\xd7"}),l]})}):null},m=e=>{let{isOpen:a,onClose:n,onSubmit:l,blogData:t,onInputChange:s,onRemoveImage:o,submissionError:r}=e;return a?(0,i.jsx)("div",{className:"modal-overlay-manageBlog",children:(0,i.jsxs)("div",{className:"modal-content-manageBlog",children:[(0,i.jsx)("button",{className:"modal-close-manageBlog",onClick:n,children:"\xd7"}),(0,i.jsx)("h3",{children:"Edit Blog Post"}),(0,i.jsxs)("form",{onSubmit:l,className:"edit-blog-form-manageBlog",children:[r&&(0,i.jsx)("p",{className:"error-message-manageBlog",children:r}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"edit-title",children:"Title:"}),(0,i.jsx)("input",{type:"text",id:"edit-title",name:"title",value:t.title,onChange:s,required:!0})]}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"edit-content",children:"Content:"}),(0,i.jsx)("textarea",{id:"edit-content",name:"content",value:t.content,onChange:s,rows:"5",required:!0})]}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"edit-author",children:"Author:"}),(0,i.jsx)("input",{type:"text",id:"edit-author",name:"author",value:t.author,onChange:s,required:!0})]}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"edit-imageUrl",children:"Image URL:"}),(0,i.jsx)("input",{type:"url",id:"edit-imageUrl",name:"imageUrl",value:t.imageUrl,onChange:s,placeholder:""}),t.imageUrl&&(0,i.jsxs)("div",{className:"current-image-preview-manageBlog",children:[(0,i.jsx)("p",{children:"Current Image:"}),(0,i.jsx)("img",{src:t.imageUrl,alt:"Current blog visual"}),(0,i.jsx)("button",{type:"button",onClick:o,className:"remove-image-btn-manageBlog",children:"Remove Image"})]}),!t.imageUrl&&(0,i.jsx)("p",{className:"no-image-text-manageBlog",children:"No image currently set. You can add one above."})]}),(0,i.jsxs)("div",{className:"form-actions-manageBlog",children:[(0,i.jsx)("button",{type:"submit",className:"submit-btn-manageBlog",children:"Update Blog"}),(0,i.jsx)("button",{type:"button",className:"cancel-btn-manageBlog",onClick:n,children:"Cancel"})]})]})]})}):null};const g=function(){const[e,a]=(0,l.useState)([]),[n,s]=(0,l.useState)(!0),[o,g]=(0,l.useState)(null),[h,u]=(0,l.useState)(!1),[x,j]=(0,l.useState)({title:"",content:"",author:"Admin",imageUrl:""}),[b,v]=(0,l.useState)(""),[p,N]=(0,l.useState)(!1),[B,C]=(0,l.useState)(null),[k,f]=(0,l.useState)({id:"",title:"",content:"",author:"",imageUrl:""}),[A,_]=(0,l.useState)(""),y=(0,l.useCallback)((()=>{s(!0),r.get("/blogs").then((e=>{a(e.data),g(null)})).catch((e=>{var a,n;(console.error("Error fetching blog data:",e),e.response&&401===e.response.status)?g("Session expired or unauthorized. Please log in again."):g("Failed to load blog data. "+((null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||e.message))})).finally((()=>s(!1)))}),[]);(0,l.useEffect)((()=>{y()}),[y]);const U=e=>{const{name:a,value:n}=e.target;j((e=>({...e,[a]:n})))},w=()=>u(!1),S=()=>{N(!1),C(null)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"dashboard-manageBlog",children:[(0,i.jsx)(t.A,{}),(0,i.jsxs)("div",{className:"main-content-manageBlog",children:[(0,i.jsx)("h2",{children:"Welcome Back!"}),(0,i.jsx)("div",{className:"stats",children:(0,i.jsxs)("div",{className:"stat",children:[(0,i.jsx)("h4",{children:"Total Posts"}),(0,i.jsx)("p",{children:e.length})]})}),(0,i.jsxs)("div",{className:"recent-blog",children:[(0,i.jsxs)("div",{className:"recent-blog-header",children:[(0,i.jsx)("h4",{children:"Recent Blogs"}),(0,i.jsx)("button",{className:"add-new",onClick:()=>{j({title:"",content:"",author:"Admin",imageUrl:""}),v(""),u(!0)},children:"+ Add New"})]}),n&&(0,i.jsx)("p",{children:"Loading blogs..."}),o&&!n&&(0,i.jsx)("p",{className:"error",children:o}),!n&&!o&&0===e.length&&(0,i.jsx)("p",{children:"No blogs found. Add one!"}),!n&&!o&&e.length>0&&(0,i.jsx)("div",{className:"blog-list-manageBlog",children:e.map((e=>{var a;return(0,i.jsxs)("div",{className:"blog-item-manageBlog",children:[e.imageUrl&&(0,i.jsx)("img",{src:e.imageUrl,alt:e.title,className:"blog-item-image-manageBlog"}),(0,i.jsxs)("div",{className:"blog-item-details-manageBlog",children:[(0,i.jsx)("h5",{className:"blog-item-title-manageBlog",children:e.title}),(0,i.jsxs)("p",{className:"blog-item-author-manageBlog",children:["Author: ",e.author||"N/A"]}),(0,i.jsxs)("div",{className:"blog-item-meta-manageBlog",children:[(0,i.jsxs)("span",{children:[e.comments_count||(null===(a=e.comments)||void 0===a?void 0:a.length)||0," Comments"]}),(0,i.jsxs)("span",{children:[e.likes||0," Likes"]}),(0,i.jsxs)("span",{children:[e.views||0," Views"]})]})]}),(0,i.jsx)("button",{className:"edit-blog-btn-manageBlog",onClick:()=>(e=>{const a=e.id||e._id;C(a),f({id:a,title:e.title||"",content:e.content||"",author:e.author||"Admin",imageUrl:e.imageUrl||""}),_(""),N(!0)})(e),children:"Edit"})]},e.id||e._id)}))})]})]})]}),(0,i.jsxs)(c,{isOpen:h,onClose:w,children:[(0,i.jsx)("h3",{children:"Add New Blog Post"}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v(""),!x.title||!x.content||!x.author)return void v("Title, Content, and Author are required.");if(d())try{await r.post("/blogs",x),y(),u(!1),j({title:"",content:"",author:"Admin",imageUrl:""})}catch(l){var a,n;console.error("Error adding new blog:",l),v("Failed to add blog. "+((null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||l.message))}else v("Authentication token not found. Please log in again.")},className:"add-blog-form-manageBlog",children:[b&&(0,i.jsx)("p",{className:"error-message-manageBlog",children:b}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"title",children:"Title:"}),(0,i.jsx)("input",{type:"text",id:"title",name:"title",value:x.title,onChange:U,required:!0})]}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"content",children:"Content:"}),(0,i.jsx)("textarea",{id:"content",name:"content",value:x.content,onChange:U,rows:"5",required:!0})]}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"author",children:"Author:"}),(0,i.jsx)("input",{type:"text",id:"author",name:"author",value:x.author,onChange:U,required:!0})]}),(0,i.jsxs)("div",{className:"form-group-manageBlog",children:[(0,i.jsx)("label",{htmlFor:"imageUrl",children:"Image URL (Optional):"}),(0,i.jsx)("input",{type:"url",id:"imageUrl",name:"imageUrl",placeholder:"https://example.com/image.png",value:x.imageUrl,onChange:U})]}),(0,i.jsxs)("div",{className:"form-actions-manageBlog",children:[(0,i.jsx)("button",{type:"submit",className:"submit-btn-manageBlog",children:"Add Blog"}),(0,i.jsx)("button",{type:"button",className:"cancel-btn-manageBlog",onClick:w,children:"Cancel"})]})]})]}),(0,i.jsx)(m,{isOpen:p,onClose:S,onSubmit:async e=>{if(e.preventDefault(),_(""),!k.title||!k.content||!k.author)return void _("Title, Content, and Author are required.");if(!d())return void _("Authentication token not found. Please log in again.");const{id:a,...n}=k;try{await r.put(`/blogs/${B}`,n),y(),S()}catch(s){var l,t;console.error("Error updating blog:",s),_("Failed to update blog. "+((null===(l=s.response)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.message)||s.message))}},blogData:k,onInputChange:e=>{const{name:a,value:n}=e.target;f((e=>({...e,[a]:n})))},onRemoveImage:()=>{f((e=>({...e,imageUrl:""})))},submissionError:A})]})}},3930:(e,a,n)=>{n.d(a,{A:()=>o});n(5043);var l=n(3216),t=n(5475),s=n(7956),i=n(579);const o=e=>{let{onLogout:a,isOpen:n,onClose:o}=e;const r=(0,l.Zp)(),d=()=>{"function"===typeof a?a():(localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),r("/login"))},c=()=>{o&&window.innerWidth<=768&&o()};return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)("div",{className:"admin-sidebar__overlay",onClick:e=>{e.target.classList.contains("admin-sidebar__overlay")&&o()},"aria-hidden":"true"}),(0,i.jsxs)("aside",{className:"admin-sidebar "+(n?"open":""),children:[(0,i.jsxs)("div",{className:"admin-sidebar__logo-section",children:[(0,i.jsx)("img",{src:s,alt:"logo",height:"50px",width:"50px"}),(0,i.jsx)("h2",{className:"admin-sidebar__title",children:"Admin Dashboard"})]}),(0,i.jsxs)("ul",{className:"admin-sidebar__menu",children:[(0,i.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,i.jsx)(t.k2,{to:"/adminDashboard",end:!0,className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Invest Dashboard"})}),(0,i.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,i.jsx)(t.k2,{to:"/adminDashboard/userManagement",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"User Management"})}),(0,i.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,i.jsx)(t.k2,{to:"/adminDashboard/manageBlog",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Manage Blog"})}),(0,i.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,i.jsx)(t.k2,{to:"/adminDashboard/transaction",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Transactions"})}),(0,i.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,i.jsx)(t.k2,{to:"/adminDashboard/withdrawals",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Withdrawals"})}),(0,i.jsx)("li",{className:"admin-sidebar__menu-item",children:(0,i.jsx)(t.k2,{to:"/adminDashboard/adminPlans",className:e=>{let{isActive:a}=e;return a?"active-link":""},onClick:c,children:"Plans"})})]}),(0,i.jsx)("div",{className:"admin-sidebar__signout",onClick:d,style:{cursor:"pointer"},tabIndex:0,role:"button",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||d()},children:"Sign Out"})]})]})}},7956:(e,a,n)=>{e.exports=n.p+"static/media/logo3.53e806f77f8987aa2fc1.png"}}]);
//# sourceMappingURL=501.44335ecf.chunk.js.map